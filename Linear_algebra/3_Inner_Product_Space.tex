% !TEX root = main.tex

\section{内积空间}
\subsection{基本定义}
\begin{definition}[内积空间]
线性空间$V$上的内积是一个函数$\langle\cdot,\cdot\rangle:V\times V\to\mathbb{R}$，$\forall u,v,w\in V,c$为常数，满足
\begin{enumerate}
	\itemsep -3pt
	\item $\langle \mathbf{u},\mathbf{v} \rangle=\langle \mathbf{v},\mathbf{u} \rangle$
	\item $\langle \mathbf{u}+\mathbf{v},\mathbf{w} \rangle=\langle \mathbf{u},\mathbf{w} \rangle+\langle \mathbf{v},\mathbf{w} \rangle$
	\item $\langle c\mathbf{u},\mathbf{v} \rangle=c\langle \mathbf{u},\mathbf{v} \rangle$
	\item $\langle \mathbf{u},\mathbf{u} \rangle\geq 0$，且$\langle \mathbf{u},\mathbf{u} \rangle=0$当且仅当$u=0$
\end{enumerate}
定义了内积的向量空间称为内积空间.
\end{definition}
\begin{definition}[长度/模/范数]
$V$是一个内积空间，则对于某一向量$v\in V$的长度为$\|v\|:=\sqrt{\langle v,v\rangle}$.
\end{definition}
注：如无特殊说明，下文在谈论到内积时都是指最简单不加权的内积，即$\inp{\vb{u}}{\vb{v}}=\vb{u}\cdot\vb{v}=\vb{u}^T\vb{v}$.

\subsection{正交}
\begin{definition}[正交]
若$\langle u,v\rangle=0$，则称$u,v$正交.\\
注：与高中的定义不同，这里我们可以说$\mathbf{0}$与任意向量正交.
\end{definition}
下面这些定理看似简单，因为有二维三维空间的几何直观作为基础，但拓展到高维空间这些定理还是否会成立呢？我们不得而知，因此还应从公理出发一一证明.
\begin{theorem}[毕达哥拉斯(Pythagoras)定理]
$u,v$正交当且仅当$\|\mathbf{u}\|^2+\|\mathbf{v}\|^2=\|\mathbf{u}+\mathbf{v}\|^2$
\end{theorem}
\begin{definition}
设$W$是向量空间$V$的子空间，$V$中与所有与$W$正交的向量构成的集合称为$W$的正交补，记为$W^\perp$.
\end{definition}
以下有两条性质
\begin{enumerate}
	\itemsep -3pt
	\item $\mathbf{x}\in W^\perp\iff\mathbf{x}$与张成$V$的一组向量中的每一个都正交
	\item $W^\perp$是$V$的子空间
\end{enumerate}
\begin{theorem}[正交必定线性无关]
\label{ortho_indep}
$S=\{\mathbf{u}_1,\dots,\mathbf{u}_p\}$是$V$的一个由\textbf{非零}向量构成的正交集，那么$S$线性无关，因此构成$\mathrm{Span}\;S$的基.\\
注：一定要注意前提条件！！！
\end{theorem}
\begin{analysis}
\[\vb{0}=c_1\vb{u}_1+c_2\vb{u}_2+\cdots+c_p\vb{u}_p\]
\[\begin{aligned}0&=\inp{\vb{0}}{\vb{u}_1}=\inp{c_1\vb{u}_1+c_2\vb{u}_2+\cdots+c_p\vb{u}_p}{\vb{u}_1}\\
&=\inp{c_1\vb{u}_1}{\vb{u}_1}+\inp{c_2\vb{u}_2}{\vb{u}_1}+\cdots+\inp{c_p\vb{u}_p}{\vb{u}_1}\\
&=c_1\inp{\vb{u}_1}{\vb{u}_1}+c_2\inp{\vb{u}_2}{\vb{u}_1}+\cdots+c_p\inp{\vb{u}_p}{\vb{u}_1}\\
&=c_1\inp{\vb{u}_1}{\vb{u}_1}
\end{aligned}\]
因为$\vb{u}_1\ne\vb{0}$，所以$c_1=0$. 类似地，可以推出$c_i=0,i=2,\dots,p$，因此$S$线性无关.
\end{analysis}
\begin{theorem}[正交分解]
$\{\mathbf{u}_1,\dots,\mathbf{u}_p\}$是$V$的子空间$W$的一组正交基，对于$\vb{y}\in V$，都可以唯一表示成$\vb{y}=\hat{\vb{y}}+\vb{z}$，其中$\hat{\vb{y}}\in W,\vb{z}\in W^\perp$，且
\[\hat{\mathbf{y}}=c_1\mathbf{u}_1+\cdots+c_p\mathbf{u}_p\]
各项为
\[\hat{\mathbf{y}}_i=\mathrm{proj}_{u_i}\hat{\mathbf{y}}=c_i\mathbf{u}_i=\frac{\langle \hat{\mathbf{y}},\mathbf{u}_i\rangle}{\langle\mathbf{u}_i,\mathbf{u}_i\rangle}\mathbf{u}_i=\frac{\langle \hat{\mathbf{y}},\mathbf{u}_i\rangle}{\|\mathbf{u}_i\|}\frac{\mathbf{u}_i}{\|\mathbf{u}_i\|}\,,i=1,\dots,p\qquad(*)\]
注：与选的基没有关系，只和$W$有关.
\end{theorem}
\begin{analysis}
类似定理\ref{ortho_indep}的证明有$\inp{\hat{\vb{y}}}{\vb{u}_i}=\inp{c_1\vb{u}_1+c_2\vb{u}_2+\cdots+c_p\vb{u}_p}{\vb{u}_i}=c_i\inp{\vb{u}_i}{\vb{u}_i}$，移项即得$(*)$式.
\[\begin{aligned}\inp{\vb{z}}{\vb{u}_1}=\inp{\vb{y}-\hat{\vb{y}}}{\vb{u}_1}&=\inp{\vb{y}}{\vb{u}_1}-\inp{\frac{\langle \hat{\mathbf{y}},\mathbf{u}_1\rangle}{\langle\mathbf{u}_1,\mathbf{u}_1\rangle}\mathbf{u}_1}{\vb{u}_1}-0-\cdots-0\\
&=\inp{\vb{y}}{\vb{u}_1}-\inp{\vb{y}}{\vb{u}_1}=0\end{aligned}\]
类似地可证明$\vb{z}$与$W$的每一个基$\vb{u}_i$都正交，进而$\vb{z}\in W^\perp$.\\
为证明唯一性，不妨设存在另一表示方法$\vb{y}=\hat{\vb{y}}'+\vb{z'}$，其中$\hat{\vb{y}}'\in W$，$\vb{z'}\in W^\perp$那么$\hat{\vb{y}}+\vb{z}=\hat{\vb{y}}'+\vb{z'}$，即$\hat{\vb{y}}-\hat{\vb{y}}'=\vb{z'}-\vb{z}$. 因为$\vb{z},\vb{z'}\in W^\perp$，所以$\vb{z'}-\vb{z}\in W^\perp$，故$\hat{\vb{y}}-\hat{\vb{y}}'\in W^\perp$，而$\hat{\vb{y}}-\hat{\vb{y}}'\in W$，推出$\inp{\hat{\vb{y}}-\hat{\vb{y}}'}{\hat{\vb{y}}-\hat{\vb{y}}'}=0$，即$\hat{\vb{y}}=\hat{\vb{y}}'$，同时$\vb{z'}=\vb{z}$.
\end{analysis}
\par 从$(*)$的最后一个等式可以看出，实际上正交分解与我们高中所学的向量知识是一致的，即$\mathbf{y}$在$\mathbf{u}_i$上的投影的长度再乘上该方向上的单位向量.
\begin{theorem}[最佳估计]
$W$为$V$的子空间，$\vb{y}\in V$，则
\[\|\mathbf{y}-\hat{\mathbf{y}}\|\leq\|\mathbf{y}-\mathbf{v}\|,\forall v\in W\]
\end{theorem}
\begin{analysis}
\[\vy-\vv=(\vy-\hat{\vy})+(\hat{\vy}-\vv)\]
因为$\hat{\vy}-\vv\in W,\vy-\hat{\vy}\in W^\perp$，所以由毕达哥拉斯定理
\[\|\vy-\vv\|^2=\|\vy-\hat{\vy}\|^2+\|\hat{\vy}-\vv\|^2\]
即得结论.
\end{analysis}
\begin{theorem}[柯西(Cauchy)不等式]
\[\|\mathbf{u}\|\|\mathbf{v}\|\geq|\langle \mathbf{u},\mathbf{v} \rangle|\]
\end{theorem}
\begin{analysis}
\[\|\proj{\vb{u}}\vv\|=\dfrac{\inp{\vb{u}}{\vv}}{\|\vb{u}\|}\leq\|\vv\|\]
\end{analysis}
\begin{theorem}[三角不等式]
\[\|\mathbf{u}\|+\|\mathbf{v}\|\geq\|\mathbf{u}+\mathbf{v}\|\]
\end{theorem}
\begin{analysis}
平方后用柯西不等式.
\end{analysis}
\begin{proposition}%P417
$A$是$m\times n$矩阵，$A\vx=\vb{0}$当且仅当$A^TA\vx=\vb{0}$，进而$\nul A=\nul A^TA$.\\
$A^TA$可逆当且仅当$A$的列线性无关. $\rank A^TA=n-\dim\nul A^TA=\nul A=\rank A$
\end{proposition}
\begin{analysis}
$\vx^TA^TA\vx=\vb{0}$
\end{analysis}

\subsection{正交矩阵}
\begin{theorem}
$U$是$m\times n$矩阵，则$U$每一列都\textbf{单位正交}当且仅当$U^TU=I$
\end{theorem}
\begin{analysis}
\[U^TU=\begin{bmatrix}\vb{u}_1^T\\\vdots\\\vb{u}_n^T\end{bmatrix}[\vb{u}_1\quad\cdots\quad\vb{u}_n]
=\begin{bmatrix}\vb{u}_1^T\vb{u}_1 & \cdots & \vb{u}_1^T\vb{u}_n\\
\vdots&\ddots&\vdots\\
\vb{u}_n^T\vb{u}_1 & \cdots & \vb{u}_n^T\vb{u}_n\\\end{bmatrix}
=\begin{bmatrix}1 & \cdots & 0\\
\vdots&\ddots&\vdots\\
0 & \cdots & 1\\\end{bmatrix}=I\]
\end{analysis}
\begin{theorem}
$U$是$m\times n$矩阵且每一列都单位正交，$x,y\in\mathbb{R}^n$
\begin{enumerate}
	\itemsep -3pt
	\item $\|U\mathbf{x}\|=\|\mathbf{x}\|$
	\item $(U\mathbf{x})\cdot(U\mathbf{y})=\mathbf{x}\cdot\mathbf{y}$
	\item $(U\mathbf{x})\cdot(U\mathbf{y})=0\iff\mathbf{x}\cdot\mathbf{y}=0$
\end{enumerate}
\end{theorem}
\begin{analysis}
$(U\mathbf{x})\cdot(U\mathbf{y})=(U\mathbf{x})^T(U\mathbf{y})=\mathbf{x}^TU^TU\mathbf{y}=\mathbf{x}\cdot\mathbf{y}$，
$1,3$同理可证.
\end{analysis}
\begin{definition}[正交矩阵]
若$U$为\textbf{方阵}且每一列都\textbf{单位正交}，则称$U$为正交矩阵.\\
注：从定义上看似乎应该叫单位正交矩阵(orthonormal matrix)比较合适，但实际上在线性代数中正交矩阵(orthogonal matrix)已经包含了单位正交的意思.
\end{definition}
由以上定理和定义可知下面几条显然的结论.
\begin{proposition}
\begin{enumerate}
	\itemsep -3pt
	\item $U$为方阵则一定可逆，因$U^TU=I=U^{-1}U=I$
	\item $U,V$均为正交矩阵，则$UV$也为正交矩阵
	\item $U$中的列交换一下得到$V$，则$V$也为正交矩阵
\end{enumerate}
\end{proposition}
\begin{proposition}
$\{\mathbf{u}_1,\dots,\mathbf{u}_p\}$是$V$的子空间$W$的一组单位正交基，则$\proj{W}\vy=UU^T\vy,\,\forall\vy\in V$
\end{proposition}
\begin{myalgorithm}[施密特(Schmidt)正交化]
\label{schmidt}
设$\{\mathbf{v}_1,\dots,\mathbf{v}_p\}$是$W$的一组基，定义
\[\begin{aligned}\mathbf {u} _{1}&=\mathbf {v} _{1}\\
\mathbf {u} _{2}&=\mathbf {v} _{2}-\mathrm {proj} _{\mathbf {u} _{1}}\vv_2\\
\vdots\\
\mathbf {u} _{p}&=\mathbf {v} _{p}-\sum _{j=1}^{p-1}\mathrm {proj} _{\mathbf {u} _{j}}\,\mathbf {v} _{p}\end{aligned}\]
则$\{\mathbf{u}_1,\dots,\mathbf{u}_p\}$是$W$的一组正交基，且
\[\mathrm{Span}\{\mathbf{v}_1,\dots,\mathbf{v}_k\}=\mathrm{Span}\{\mathbf{u}_1,\dots,\mathbf{u}_k\},\forall\;1\leq k\leq p\]
注：此过程说明了结合向量空间基的存在性可说明正交基的存在性.
\end{myalgorithm}
\begin{analysis}
设$V_k=\span\{\mathbf{v}_1,\dots,\mathbf{v}_k\},W_k=\span\{\mathbf{u}_1,\dots,\mathbf{u}_k\},1\leq k\leq p$，则$\vb{u}_{k+1}=\vv_{k+1}-\proj{W_k}\vv_{k+1}$，进而$\vb{u}_{k+1}\in W_{k+1}^\perp$，即每一$\vb{u}_i$均与前面的$\vb{u}_j,1\leq j\leq i-1$正交（也就保证了两两正交）. 而$\vb{v}_i\in V_i$，由向量加减法的封闭性，$\vb{u}_i\in V_i$，故$\vb{u}_i\in V_p$（因$V_k\subset V_{k+1}$）. 又正交一定线性无关，且$V$已有一组$p$个向量的基，故$\{\mathbf{u}_1,\dots,\mathbf{u}_k\}$是$V_k$的一组正交基，进而$V_k=W_k$.\\
\end{analysis}
\begin{theorem}[QR分解]
\label{qr_fact}
若$m\times n$矩阵$A$的\textbf{列线性无关}，则$A$可被分解为$A=QR$，其中$Q$是$m\times n$矩阵且它的列形成$\col A$的\textbf{单位正交}基，$R$是$n\times n$可逆上三角矩阵且对角线上元素全为正数.\\
注：在下面的证明可以看出$A=QR$，单位正交不是必须的，但可能因为具有某种性质，所以才要强调单位正交.
\end{theorem}
\begin{analysis}
施密特正交化将$A$的列转为正交基$\{\mathbf{u}_1,\dots,\mathbf{u}_n\}$，则$Q=\bmat{\vb{u}_1}{\vb{u}_n}$.\\
由算法\ref{schmidt}的分析知$\vx_k\in V_k=W_k$，故存在$r_{k1},\dots,r_{kk}$，使得
\[\vx_k=r_{k1}\vb{u}_1+\cdots+r_{kk}\vb{u}_k+0\cdot\vb{u}_{k+1}+\cdots+0\cdot\vb{u}_n\]
假设$r_{kk}\geq 0$（否则给$r_{kk}$和$\vb{u}_k$同乘$-1$），令
\[\vb{r}_k=\begin{bmatrix}r_{k1}\\\vdots\\r_{kk}\\0\\\vdots\\0\end{bmatrix}\]
为$R$的列，显然$R$为上三角，即可满足$\vx_k=Q\vb{r}_k$.
\end{analysis}
\begin{myalgorithm}[QR分解]
\begin{enumerate}
	\itemsep -3pt
	\item 先将$A$的列向量单位正交化，得到$Q$
	\item 通过$R=IR=Q^TQR=Q^TA$计算得$R$
\end{enumerate}
\end{myalgorithm}